(function(t){function e(e){for(var a,r,o=e[0],c=e[1],d=e[2],l=0,p=[];l<o.length;l++)r=o[l],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&p.push(n[r][0]),n[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,d||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],a=!0,o=1;o<i.length;o++){var c=i[o];0!==n[c]&&(a=!1)}a&&(s.splice(e--,1),t=r(r.s=i[0]))}return t}var a={},n={app:0},s=[];function r(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=a,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(i,a,function(e){return t[e]}.bind(null,a));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var d=0;d<o.length;d++)e(o[d]);var u=c;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";var a=i("85ec"),n=i.n(a);n.a},1:function(t,e){},2864:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var a=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("game")},s=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("md-app",[i("md-app-content",{attrs:{id:"aplicacion"}},[i("div",{staticClass:"md-layout"},[i("div",{staticClass:"md-layout-item md-size-40"},[i("div",{staticClass:"md-layout",attrs:{id:"divPuntos"}},[i("div",{staticClass:"md-layout-item md-size-50 h-80"},[i("span",{staticClass:"md-display-4 puntuacion marcador",attrs:{id:"marcador1"}},[t._v(t._s(t.partida.local.puntos))]),i("h2",{staticClass:"md-display-3 marcadorlocal"},[t._v(t._s(t.marcador.local))]),i("md-list",{staticClass:"lista"},t._l(t.partida.local.tiradas,(function(e){return i("md-list-item",{key:e},[i("div",{staticClass:"md-list-item-text puntuacion md-subheading"},[t._v(" "+t._s(e)+" ")])])})),1)],1),i("div",{staticClass:"md-layout-item md-size-50 h-80"},[i("span",{staticClass:"md-display-4 puntuacion marcador"},[t._v(t._s(t.partida.visitante.puntos))]),i("h2",{staticClass:"md-display-3 marcadorvisitante"},[t._v(t._s(t.marcador.visitante))]),i("md-list",{staticClass:"lista"},t._l(t.partida.visitante.tiradas,(function(e){return i("md-list-item",{key:e},[i("div",{staticClass:"md-list-item-text puntuacion md-subheading"},[t._v(" "+t._s(e)+" ")])])})),1)],1),i("div",{staticClass:"md-layout-item md-size-100",attrs:{id:"estadisticas"}},[i("h2",{staticClass:"centrado"},[t._v("Estadísticas")]),i("div",{staticClass:"md-layout"},[i("br"),i("div",{staticClass:"md-layout-item md-size-50"},[i("h4",{staticClass:"centrado"},[i("b",[t._v("Media: "+t._s(t.partida.local.media))])])]),i("div",{staticClass:"md-layout-item md-size-50"},[i("h4",{staticClass:"centrado"},[i("b",[t._v("Media: "+t._s(t.partida.visitante.media))])])])])]),i("div",{staticClass:"md-layout-item md-size-100 h-20",attrs:{id:"inputPuntos"}},[i("div",{staticClass:"md-layout-item md-size-100 centrado"},[t._v(t._s(t.textoTurno))]),i("hr"),i("div",{staticClass:"md-layout"},[i("div",{staticClass:"md-layout-item md-size-70"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"input",attrs:{type:"text",disabled:t.turno,id:"puntuacion",placeholder:"Introduce tu puntuación",autofocus:""},domProps:{value:t.input},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.enter(e)},input:function(e){e.target.composing||(t.input=e.target.value)}}})]),i("div",{staticClass:"md-layout-item md-size-30"},[i("md-button",{staticClass:"md-raised md-primary enviarPuntuacion",attrs:{disabled:t.validar},on:{click:t.enviarPuntuacion}},[t._v("Enviar")])],1)])])])]),i("div",{staticClass:"md-layout-item md-size-60",attrs:{id:"divCamaras"}},[i("video",{staticClass:"md-elevation-5",attrs:{id:"remote",autoplay:""}}),i("video",{staticClass:"md-elevation-5",attrs:{id:"local",autoplay:"",muted:""},domProps:{muted:!0}})])])])],1)},o=[],c=(i("ac1f"),i("466d"),i("8055")),d=i.n(c),u={name:"Game",props:[],mounted:function(){var t=this,e=document.getElementById("local");this.socket.on("preparado",(function(){t.pc=new RTCPeerConnection(t.pcConf),t.pc.addStream(e.srcObject),t.pc.createOffer().then((function(e){return t.pc.setLocalDescription(e)})).then((function(){t.socket.emit("offer",t.pc.localDescription)})),t.pc.ontrack=function(t){document.getElementById("remote").srcObject=t.streams[0]},t.id="local"})),this.socket.on("offer",(function(i){t.pc=new RTCPeerConnection(t.pcConf),t.pc.addStream(e.srcObject),t.pc.setRemoteDescription(i).then((function(){return t.pc.createAnswer()})).then((function(e){return t.pc.setLocalDescription(e)})).then((function(){t.socket.emit("answer",t.pc.localDescription)})),t.pc.ontrack=function(t){document.getElementById("remote").srcObject=t.streams[0]},t.pc.onicecandidate=function(e){e.candidate&&t.socket.emit("candidate",e.candidate)},t.id="visitante"})),this.socket.on("candidate",(function(e){t.pc.addIceCandidate(new RTCIceCandidate(e)).catch((function(t){return console.error(t)})),t.socket.emit("comenzarPartida")})),this.socket.on("answer",(function(e){t.pc.setRemoteDescription(e)})),this.socket.on("comenzarPartida",(function(e){console.log("comenzar partida"),t.partida=e,t.partida.turno==t.id&&document.getElementById("puntuacion").focus()})),this.socket.on("ganador",(function(e){t.marcador[e]++})),this.socket.on("tirada",(function(e){t.partida=e,t.partida.turno==t.id&&document.getElementById("puntuacion").focus()})),this.getUserMediaDevices()},data:function(){return{socket:d()(),pc:null,partida:{local:{puntos:501,nDardos:0,media:0},visitante:{puntos:501,nDardos:0,media:0},turno:null},marcador:{local:0,visitante:0},input:null,id:null,constraints:{audio:!0,video:{facingMode:"user"}},pcConf:{iceServers:[{urls:["stun:stun.l.google.com:19302"]}]},gettingUserMedia:!1}},methods:{enviarPuntuacion:function(){var t={puntos:parseInt(this.input),dardos:3};console.log(t),this.socket.emit("tirada",t),this.input=null},getUserMediaDevices:function(){var t=document.getElementById("local");t instanceof HTMLVideoElement&&(t.srcObject?(this.getUserMediaSuccess(t.srcObject),this.gettingUserMedia=!1):this.gettingUserMedia||t.srcObject||(this.gettingUserMedia=!0,navigator.mediaDevices.getUserMedia(this.constraints).then(this.getUserMediaSuccess).catch(this.getUserMediaError)))},getUserMediaSuccess:function(t){var e=document.getElementById("local");this.gettingUserMedia=!1,e instanceof HTMLVideoElement&&!e.srcObject&&(e.srcObject=t),this.socket.emit("preparado")},getUserMediaError:function(t){console.error(t),this.gettingUserMedia=!1},enter:function(){this.validar||this.enviarPuntuacion()}},computed:{validar:function(){if(!this.input)return!0;if(!this.input.match(/^[0-9]*$/))return!0;var t=parseInt(this.input);return t<0||t>180||t>this.partida[this.partida.turno].puntos},turno:function(){return!this.partida.turno||this.id!=this.partida.turno},textoTurno:function(){return this.partida.turno?this.id==this.partida.turno?"Es tu turno, introduce tu puntuación":"Espera a que el oponente tire":"cargando"}}},l=u,p=(i("bd18"),i("2877")),m=Object(p["a"])(l,r,o,!1,null,"86af1da6",null),f=m.exports,v={name:"App",components:{Game:f}},h=v,y=(i("034f"),Object(p["a"])(h,n,s,!1,null,null,null)),g=y.exports,C=i("43f9"),b=i.n(C);i("51de"),i("d69d");a["default"].config.productionTip=!1,a["default"].use(b.a),new a["default"]({render:function(t){return t(g)}}).$mount("#app")},"85ec":function(t,e,i){},bd18:function(t,e,i){"use strict";var a=i("2864"),n=i.n(a);n.a}});
//# sourceMappingURL=app.a70568e8.js.map